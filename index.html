<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Airtable Voting Example</title>
    <script>
        const personalAccessToken = 'patF168MAz3MesHoR.516feaa589f87ba8582af184a19fe1f7899148caf48f2d0c7fa8ead6173093d5'; // Your Airtable personal access token
        const baseId = 'appB5rcjMWKBR3VEx'; // Your Airtable base ID
        const tableId = 'tblpW7s9SsqKPtgtE'; // Your Airtable table ID
        const recordId = 'recnbYjhMTeR18RB0'; // Your record ID

        // Function to update likes/dislikes
        async function updateVote(voteType) {
            try {
                // Fetch current record data to get existing counts
                const currentDataResponse = await fetch(`https://api.airtable.com/v0/${baseId}/${tableId}/${recordId}`, {
                    headers: {
                        Authorization: `Bearer ${personalAccessToken}`,
                    }
                });

                if (!currentDataResponse.ok) {
                    throw new Error(`HTTP error while fetching current data! status: ${currentDataResponse.status}`);
                }

                const currentData = await currentDataResponse.json();
                const currentCount = currentData.fields[voteType] || 0; // Get the current count or default to 0

                // Update the record with the incremented count
                const updateResponse = await fetch(`https://api.airtable.com/v0/${baseId}/${tableId}/${recordId}`, {
                    method: 'PATCH',
                    headers: {
                        Authorization: `Bearer ${personalAccessToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        fields: {
                            [voteType]: currentCount + 1 // Increment the current count
                        }
                    })
                });

                if (!updateResponse.ok) {
                    throw new Error(`HTTP error while updating votes! status: ${updateResponse.status}`);
                }

                const updatedData = await updateResponse.json();
                console.log(updatedData);
            } catch (error) {
                console.error('Error updating votes:', error);
            }
        }

        // Example usage
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('likeBtn').onclick = function() {
                updateVote('Likes'); // Update likes
            };
            document.getElementById('dislikeBtn').onclick = function() {
                updateVote('Dislikes'); // Update dislikes
            };
        });
    </script>
</head>
<body>

<h2>Vote for this Content</h2>
<button id="likeBtn">👍 Like</button>
<button id="dislikeBtn">👎 Dislike</button>

</body>
</html>